
<!doctype html>
<html>
<!--
    This is the code for HTML file that will be generated once the user runs the program.
    It's greatly inspired by the code from Prof Scott's ascii_disassem.html file. The javascript,
    HMTL, and CSS have mostly been copied word for word from the doc.
-->
<style>
button {
    border: none;
    margin: none;
    font-family: "Courier New", "Courier", "monospace";
    background-color: Azure;
}
button[onclick] {
    background-color: LightCyan;
}
button[onclick]:hover {
    background-color: PaleGreen;
}
#assembly {
    height: 88vh;
    overflow: auto;
    font-family: "Courier New", "Courier", "monospace";
    font-size: 80%;
    white-space: pre
}
#source {
    height: 88vh;
    overflow: auto;
    font-family: "Courier New", "Courier", "monospace";
    font-size: 80%;
    white-space: pre
}
table {
    border-spacing: 0px;
}
td {
    padding: 0px;
    padding-right: 15px;
}
</style>

<body>
<script>
// scroll line into the middle of its respective subwindow
function reveal(line) {
  const element = document.getElementById(line);
  element.scrollIntoView({
    behavior: 'auto',
    block: 'center',
    inline: 'center'
  });
}
// green-highlight aline,
// yellow-highlight all source lines that contributed to aline,
// and scroll sline into view
function aclick(aline, sline) {
  const sLines = document.querySelectorAll("span[aline]");  // slines have an aline list
  const aLines = document.querySelectorAll("span[sline]");  // alines have an sline list
  // clear all assembly lines
  aLines.forEach((l) => {
    l.style.backgroundColor = 'white';
  })
  sLines.forEach((sl) => {
    if (sl.matches("span[aline~="+aline+"]")) {
        sl.style.backgroundColor = 'yellow';
        aLines.forEach((al) => {
          if (al.matches("span[sline~="+sl.id+"]")) {
            al.style.backgroundColor = 'PapayaWhip';
          }
        })
    } else {
        sl.style.backgroundColor = 'white';
    }
  })
  const l = document.getElementById(aline);
  l.style.backgroundColor = 'PaleGreen';
  reveal(sline);
}
// green-highlight sline,
// yellow-highlight all assembly lines that correspond to sline,
// and scroll aline into view
function sclick(sline, aline) {
  const aLines = document.querySelectorAll("span[sline]");  // alines have an sline list
  const sLines = document.querySelectorAll("span[aline]");  // slines have an aline list
  // clear all source lines
  sLines.forEach((l) => {
    l.style.backgroundColor = 'white';
  })
  aLines.forEach((l) => {
    if (l.matches("span[sline~="+sline+"]")) {
        l.style.backgroundColor = 'yellow';
    } else {
        l.style.backgroundColor = 'white';
    }
  })
  const l = document.getElementById(sline);
  l.style.backgroundColor = 'PaleGreen';
  reveal(aline);
}
</script>

<h1>ascii.c</h1>

<table width="100%">
<tr>
<td width="49%">
<h2>source</h2>
<div id="source">
<button>&nbsp;&nbsp;1</button> <span id="s1" aline= "">/* This program gives information about an ascii code.</span>
<button>&nbsp;&nbsp;2</button> <span id="s2" aline= "">** Its arguments are taken as octal, hex, or decimal numbers</span>
<button>&nbsp;&nbsp;3</button> <span id="s3" aline= "">** and it prints information about the character.</span>
<button>&nbsp;&nbsp;4</button> <span id="s4" aline= "">** With an argument of -, all values are printed.</span>
<button>&nbsp;&nbsp;5</button> <span id="s5" aline= "">** With no argument, ascii expects characters from the keyboard.</span>
<button>&nbsp;&nbsp;6</button> <span id="s6" aline= "">** To exit, push the same key three times in a row.</span>
<button>&nbsp;&nbsp;7</button> <span id="s7" aline= "">*/</span>
<button>&nbsp;&nbsp;8</button> <span id="s8" aline= "">#include &lt;stdlib.h&gt;</span>
<button>&nbsp;&nbsp;9</button> <span id="s9" aline= "">#include &lt;stdio.h&gt;</span>
<button>&nbsp;&nbsp;10</button> <span id="s10" aline= "">#include &lt;termios.h&gt;</span>
<button>&nbsp;&nbsp;11</button> <span id="s11" aline= "">#include &lt;unistd.h&gt;</span>
<button>&nbsp;&nbsp;12</button> <span id="s12" aline= "">#include &lt;ctype.h&gt;</span>
<button>&nbsp;&nbsp;13</button> <span id="s13" aline= "">char *value[] = {</span>
<button>&nbsp;&nbsp;14</button> <span id="s14" aline= "">    "nul   ^@", "soh   ^A", "stx   ^B", "etx   ^C", "eot   ^D", "enq   ^E", "ack   ^F", "bel   ^G",</span>
<button>&nbsp;&nbsp;15</button> <span id="s15" aline= "">    "bs    ^H", "ht    ^I", "nl    ^J", "vt    ^K", "np    ^L", "cr    ^M", "so    ^N", "si    ^O",</span>
<button>&nbsp;&nbsp;16</button> <span id="s16" aline= "">    "dle   ^P", "dc1   ^Q", "dc2   ^R", "dc3   ^S", "dc4   ^T", "nak   ^U", "syn   ^V", "etb   ^W",</span>
<button>&nbsp;&nbsp;17</button> <span id="s17" aline= "">    "can   ^X", "em    ^Y", "sub   ^Z", "esc   ^[",</span>
<button>&nbsp;&nbsp;18</button> <span id="s18" aline= "">                "fs    ^\\  ^shL", "gs    ^]  ^shM",</span>
<button>&nbsp;&nbsp;19</button> <span id="s19" aline= "">                "rs    ^^  ^shN",  "us    ^_  ^shO",</span>
<button>&nbsp;&nbsp;20</button> <span id="s20" aline= "">    "sp", "!", "\"", "#", "$", "%", "&", "'",</span>
<button>&nbsp;&nbsp;21</button> <span id="s21" aline= "">    "(", ")", "*", "+", ",", "-", ".", "/",</span>
<button>&nbsp;&nbsp;22</button> <span id="s22" aline= "">    "0", "1", "2", "3", "4", "5", "6", "7",</span>
<button>&nbsp;&nbsp;23</button> <span id="s23" aline= "">    "8", "9", ":", ";", "&lt;", "=", "&gt;", "?",</span>
<button>&nbsp;&nbsp;24</button> <span id="s24" aline= "">    "@", "A", "B", "C", "D", "E", "F", "G",</span>
<button>&nbsp;&nbsp;25</button> <span id="s25" aline= "">    "H", "I", "J", "K", "L", "M", "N", "O",</span>
<button>&nbsp;&nbsp;26</button> <span id="s26" aline= "">    "P", "Q", "R", "S", "T", "U", "V", "W",</span>
<button>&nbsp;&nbsp;27</button> <span id="s27" aline= "">    "X", "Y", "Z", "[", "\\", "]", "^", "_",</span>
<button>&nbsp;&nbsp;28</button> <span id="s28" aline= "">    "`", "a", "b", "c", "d", "e", "f", "g",</span>
<button>&nbsp;&nbsp;29</button> <span id="s29" aline= "">    "h", "i", "j", "k", "l", "m", "n", "o",</span>
<button>&nbsp;&nbsp;30</button> <span id="s30" aline= "">    "p", "q", "r", "s", "t", "u", "v", "w",</span>
<button>&nbsp;&nbsp;31</button> <span id="s31" aline= "">    "x", "y", "z", "{", "|", "}", "~", "del   ^?"</span>
<button>&nbsp;&nbsp;32</button> <span id="s32" aline= "">};</span>
<button>&nbsp;&nbsp;33</button> <span id="s33" aline= "">static void show_char(int c) {</span>
<button>&nbsp;&nbsp;34</button> <span id="s34" aline= "">    printf(" %#4x  %#4o  %3d    %s\n", c, c, c, value[c]);</span>
<button>&nbsp;&nbsp;35</button> <span id="s35" aline= "">}</span>
<button onclick="sclick('s36','a1')">&nbsp;&nbsp;36</button> <span id="s36" aline= "a1 a2">int main(int argc, char **argv) {</span>
<button onclick="sclick('s37','a3')">&nbsp;&nbsp;37</button> <span id="s37" aline= "a3 a9 a4 a5 a6 a7 a8 a10">    struct termios orig, new;</span>
<button onclick="sclick('s38','a11')">&nbsp;&nbsp;38</button> <span id="s38" aline= "a11 a12">    int base, current, last, lastlast;</span>
<button>&nbsp;&nbsp;39</button> <span id="s39" aline= "">    current = last = lastlast = -1;</span>
<button onclick="sclick('s40','a13')">&nbsp;&nbsp;40</button> <span id="s40" aline= "a13 a14 a15 a16 a17">    if (argc &gt; 1) {</span>
<button onclick="sclick('s41','a18')">&nbsp;&nbsp;41</button> <span id="s41" aline= "a18">        if (*argv[1] == '-') {</span>
<button onclick="sclick('s42','a18')">&nbsp;&nbsp;42</button> <span id="s42" aline= "a18">            for (current = 0; current &lt;= 127; current++)</span>
<button onclick="sclick('s43','a18')">&nbsp;&nbsp;43</button> <span id="s43" aline= "a18 a113 a114">            show_char(current);</span>
<button onclick="sclick('s44','a18')">&nbsp;&nbsp;44</button> <span id="s44" aline= "a18 a19 a20 a21">        } else {</span>
<button onclick="sclick('s45','a22')">&nbsp;&nbsp;45</button> <span id="s45" aline= "a22 a23 a24">            for (int i = 1; i &lt; argc; i++) {</span>
<button onclick="sclick('s46','a32')">&nbsp;&nbsp;46</button> <span id="s46" aline= "a32 a35 a36 a37 a38">                char *cp = argv[i];</span>
<button onclick="sclick('s47','a33')">&nbsp;&nbsp;47</button> <span id="s47" aline= "a33 a123 a34">                current = 0;</span>
<button>&nbsp;&nbsp;48</button> <span id="s48" aline= "">                switch (*cp) {</span>
<button onclick="sclick('s49','a75')">&nbsp;&nbsp;49</button> <span id="s49" aline= "a75 a76 a123 a77 a124">                case '0':</span>
<button onclick="sclick('s50','a78')">&nbsp;&nbsp;50</button> <span id="s50" aline= "a78">                    base = 8;</span>
<button onclick="sclick('s51','a79')">&nbsp;&nbsp;51</button> <span id="s51" aline= "a79">                    cp++;</span>
<button onclick="sclick('s52','a44')">&nbsp;&nbsp;52</button> <span id="s52" aline= "a44 a79 a80 a81 a82 a83 a84 a85">                    if (*cp != 'x')</span>
<button>&nbsp;&nbsp;53</button> <span id="s53" aline= "">                        break;</span>
<button onclick="sclick('s54','a39')">&nbsp;&nbsp;54</button> <span id="s54" aline= "a39 a40">                    /* else fall through */</span>
<button onclick="sclick('s55','a39')">&nbsp;&nbsp;55</button> <span id="s55" aline= "a39">                case 'x':</span>
<button onclick="sclick('s56','a40')">&nbsp;&nbsp;56</button> <span id="s56" aline= "a40 a41 a42 a43">                    base = 16;</span>
<button>&nbsp;&nbsp;57</button> <span id="s57" aline= "">                    cp++;</span>
<button>&nbsp;&nbsp;58</button> <span id="s58" aline= "">                    break;</span>
<button>&nbsp;&nbsp;59</button> <span id="s59" aline= "">                default:</span>
<button onclick="sclick('s60','a30')">&nbsp;&nbsp;60</button> <span id="s60" aline= "a30 a31 a32 a45 a46">                    base = 10;</span>
<button onclick="sclick('s61','a45')">&nbsp;&nbsp;61</button> <span id="s61" aline= "a45">                }</span>
<button onclick="sclick('s62','a46')">&nbsp;&nbsp;62</button> <span id="s62" aline= "a46 a47">                for (;; ++cp) {</span>
<button>&nbsp;&nbsp;63</button> <span id="s63" aline= "">                    int d;</span>
<button>&nbsp;&nbsp;64</button> <span id="s64" aline= "">                    if (!isxdigit (*cp))</span>
<button>&nbsp;&nbsp;65</button> <span id="s65" aline= "">                        break;</span>
<button onclick="sclick('s66','a56')">&nbsp;&nbsp;66</button> <span id="s66" aline= "a56 a57">                    if (isdigit (*cp))</span>
<button onclick="sclick('s67','a57')">&nbsp;&nbsp;67</button> <span id="s67" aline= "a57">                        d = *cp - '0';</span>
<button onclick="sclick('s68','a25')">&nbsp;&nbsp;68</button> <span id="s68" aline= "a25 a26 a30 a57 a60 a86 a89 a27 a28 a29 a58 a59 a61 a87 a88">                    else if (isupper (*cp))</span>
<button>&nbsp;&nbsp;69</button> <span id="s69" aline= "">                        d = *cp - 'A' + 10;</span>
<button onclick="sclick('s70','a62')">&nbsp;&nbsp;70</button> <span id="s70" aline= "a62 a63">                    else</span>
<button onclick="sclick('s71','a64')">&nbsp;&nbsp;71</button> <span id="s71" aline= "a64 a65 a66">                        d = *cp - 'a' + 10;</span>
<button onclick="sclick('s72','a48')">&nbsp;&nbsp;72</button> <span id="s72" aline= "a48 a49">                    if (d &gt; base)</span>
<button onclick="sclick('s73','a50')">&nbsp;&nbsp;73</button> <span id="s73" aline= "a50 a51">                        break;</span>
<button>&nbsp;&nbsp;74</button> <span id="s74" aline= "">                    current = base * current + d;</span>
<button onclick="sclick('s75','a67')">&nbsp;&nbsp;75</button> <span id="s75" aline= "a67 a68 a69 a70">                }</span>
<button onclick="sclick('s76','a52')">&nbsp;&nbsp;76</button> <span id="s76" aline= "a52 a53">                if (*cp != '\0') {</span>
<button>&nbsp;&nbsp;77</button> <span id="s77" aline= "">                    printf("%s???\n", cp);</span>
<button onclick="sclick('s78','a54')">&nbsp;&nbsp;78</button> <span id="s78" aline= "a54 a55 a56">                    exit(1);</span>
<button>&nbsp;&nbsp;79</button> <span id="s79" aline= "">                }</span>
<button onclick="sclick('s80','a70')">&nbsp;&nbsp;80</button> <span id="s80" aline= "a70 a71">                if (current &lt;= 127) {</span>
<button onclick="sclick('s81','a89')">&nbsp;&nbsp;81</button> <span id="s81" aline= "a89 a90 a91">                    show_char(current);</span>
<button onclick="sclick('s82','a92')">&nbsp;&nbsp;82</button> <span id="s82" aline= "a92 a118 a93">                }</span>
<button>&nbsp;&nbsp;83</button> <span id="s83" aline= "">                else printf("value %s out of range\n", argv[i]);</span>
<button onclick="sclick('s84','a72')">&nbsp;&nbsp;84</button> <span id="s84" aline= "a72 a118 a73 a119 a120">            }</span>
<button onclick="sclick('s85','a74')">&nbsp;&nbsp;85</button> <span id="s85" aline= "a74 a75">        }</span>
<button>&nbsp;&nbsp;86</button> <span id="s86" aline= "">    } else {</span>
<button onclick="sclick('s87','a94')">&nbsp;&nbsp;87</button> <span id="s87" aline= "a94 a95 a96 a98 a99 a97">        (void) tcgetattr(2, &orig);</span>
<button>&nbsp;&nbsp;88</button> <span id="s88" aline= "">        new = orig;</span>
<button>&nbsp;&nbsp;89</button> <span id="s89" aline= "">        (void) cfmakeraw(&new);</span>
<button>&nbsp;&nbsp;90</button> <span id="s90" aline= "">        (void) tcsetattr(2, TCSANOW, &new);</span>
<button onclick="sclick('s91','a99')">&nbsp;&nbsp;91</button> <span id="s91" aline= "a99 a101 a102 a100">        while (((current = (0177 & getchar())) != last) || (current != lastlast)) {</span>
<button onclick="sclick('s92','a103')">&nbsp;&nbsp;92</button> <span id="s92" aline= "a103 a104 a105 a106">            lastlast = last;</span>
<button onclick="sclick('s93','a107')">&nbsp;&nbsp;93</button> <span id="s93" aline= "a107 a108">            last = current;</span>
<button>&nbsp;&nbsp;94</button> <span id="s94" aline= "">            show_char(current);</span>
<button onclick="sclick('s95','a109')">&nbsp;&nbsp;95</button> <span id="s95" aline= "a109 a110 a111 a112">            putchar('\r');      // device is raw</span>
<button onclick="sclick('s96','a113')">&nbsp;&nbsp;96</button> <span id="s96" aline= "a113 a115 a123 a125 a127 a126 a128 a129 a130">        }</span>
<button onclick="sclick('s97','a116')">&nbsp;&nbsp;97</button> <span id="s97" aline= "a116 a121">        (void) tcsetattr(2, TCSANOW, &orig);</span>
<button onclick="sclick('s98','a116')">&nbsp;&nbsp;98</button> <span id="s98" aline= "a116 a122">    }</span>
<button onclick="sclick('s99','a116')">&nbsp;&nbsp;99</button> <span id="s99" aline= "a116 a117">}</span>
</div>
</td>
<td width="49%">
<h2>assembly</h2>
<div id="assembly">
</div>
</td>
</tr>
</table>

</body>
</html>
